"use strict";(self.webpackChunkhx_loli_hub=self.webpackChunkhx_loli_hub||[]).push([[1907],{67989:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var r=a(96540),n=a(56347);const o=(0,r.forwardRef)(((e,t)=>{const{autosave:a=!1,baseUrl:n,urlParameters:o,configuration:s,xml:i,csv:c,exportFormat:l,onAutoSave:m,onSave:p,onClose:d,onLoad:u,onConfigure:g,onDraft:f,onExport:x,onMerge:v,onPrompt:h,onTemplate:E}=e,w=(0,r.useRef)(null),b=(e=>{const t=(t,a)=>{e.current?.contentWindow?.postMessage(JSON.stringify({action:t,...a}),"*")};return{load:e=>{t("load",e)},configure:e=>{t("configure",e)},merge:e=>{t("merge",e)},dialog:e=>{t("dialog",e)},prompt:e=>{t("prompt",e)},template:e=>{t("template",e)},layout:e=>{t("layout",e)},draft:e=>{t("draft",e)},status:e=>{t("status",e)},spinner:e=>{t("spinner",e)},exportDiagram:e=>{t("export",e)}}})(w),S=((e,t,a)=>{const r=new URL(e??"https://embed.diagrams.net"),n=new URLSearchParams;return n.append("embed","1"),n.append("proto","json"),a&&n.append("configure","1"),t&&Object.keys(t).forEach((e=>{const a=t[e];void 0!==a&&("boolean"==typeof a?n.append(e,a?"1":"0"):n.append(e,a.toString()))})),r.search=n.toString(),r.toString()})(n,o,!!s),[y,j]=(0,r.useState)(!1),k=e=>{!function(e,t,a){if(e.origin.includes("embed.diagrams.net")||!a||e.origin.includes(a))try{const a=JSON.parse(e.data);if(a.event in t){const e=t[a.event];e&&e(a)}}catch{}}(e,{init:()=>{j(!0)},load:e=>{u&&u(e)},configure:e=>{s&&b.configure({config:s}),g&&g(e)},autosave:e=>{m&&m(e)},save:e=>{b.exportDiagram({format:l||"xmlsvg",exit:e.exit,parentEvent:"save"})},exit:e=>{d&&d(e)},draft:e=>{f&&f(e)},export:e=>{p&&p({event:"save",xml:e.data,parentEvent:e.message.parentEvent||"export"}),x&&x(e),e.message.exit&&d&&d({event:"exit",modified:!0,parentEvent:e.message.parentEvent||"export"})},merge:e=>{v&&v(e)},prompt:e=>{h&&h(e)},template:e=>{E&&E(e)}},n)};return(0,r.useImperativeHandle)(t,(()=>({...b})),[]),(0,r.useEffect)((()=>{let e={};y&&(e=i?"xmlpng"===l?{xmlpng:i}:{xml:i}:c?{descriptor:{format:"csv",data:c}}:{xml:""},e={...e,autosave:a},b.load(e))}),[y,i,c,a]),(0,r.useEffect)((()=>(window.addEventListener("message",k),()=>{window.removeEventListener("message",k)})),[]),r.createElement("iframe",{className:"diagrams-iframe",src:S,ref:w,title:"Diagrams.net",style:{width:"100%",height:"100%",minWidth:"400px",minHeight:"400px",border:"none"}})}));var s=a(74848);const i=()=>{const e=new URLSearchParams((0,n.zy)().search).get("src"),[t,a]=(0,r.useState)(null);return(0,r.useEffect)((()=>{e&&(async e=>{try{const t=await fetch(e),r=(e=>{const t=(new TextEncoder).encode(e);let a="";return t.forEach((e=>{a+=String.fromCharCode(e)})),btoa(a)})(await t.text());a(`data:image/svg+xml;base64,${r}`)}catch(t){console.error("\u52a0\u8f7d SVG \u6587\u4ef6\u5931\u8d25:",t)}})(e)}),[e]),(0,s.jsx)("div",{style:{height:"100vh",display:"flex",flexDirection:"column"},children:t?(0,s.jsx)(o,{xml:t,urlParameters:{ui:"dark",spin:!0,libraries:!0,saveAndExit:!1}}):(0,s.jsxs)("p",{children:["\u672a\u627e\u5230\u56fe\u5f62\u6587\u4ef6: ",e]})})},c=()=>{const{src:e}=(0,n.g)();return(0,s.jsx)(i,{})}}}]);