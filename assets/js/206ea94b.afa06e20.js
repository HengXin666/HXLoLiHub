"use strict";(self.webpackChunkhx_loli_hub=self.webpackChunkhx_loli_hub||[]).push([[3718],{14682:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var a=n(96540),r=n(56347);const o=(0,a.forwardRef)(((e,t)=>{const{autosave:n=!1,baseUrl:r,urlParameters:o,configuration:s,xml:i,csv:c,exportFormat:l,onAutoSave:p,onSave:m,onClose:d,onLoad:u,onConfigure:f,onDraft:g,onExport:x,onMerge:v,onPrompt:h,onTemplate:E}=e,w=(0,a.useRef)(null),b=(e=>{const t=(t,n)=>{e.current?.contentWindow?.postMessage(JSON.stringify({action:t,...n}),"*")};return{load:e=>{t("load",e)},configure:e=>{t("configure",e)},merge:e=>{t("merge",e)},dialog:e=>{t("dialog",e)},prompt:e=>{t("prompt",e)},template:e=>{t("template",e)},layout:e=>{t("layout",e)},draft:e=>{t("draft",e)},status:e=>{t("status",e)},spinner:e=>{t("spinner",e)},exportDiagram:e=>{t("export",e)}}})(w),S=((e,t,n)=>{const a=new URL(e??"https://embed.diagrams.net"),r=new URLSearchParams;return r.append("embed","1"),r.append("proto","json"),n&&r.append("configure","1"),t&&Object.keys(t).forEach((e=>{const n=t[e];void 0!==n&&("boolean"==typeof n?r.append(e,n?"1":"0"):r.append(e,n.toString()))})),a.search=r.toString(),a.toString()})(r,o,!!s),[y,j]=(0,a.useState)(!1),k=e=>{!function(e,t,n){if(e.origin.includes("embed.diagrams.net")||!n||e.origin.includes(n))try{const n=JSON.parse(e.data);if(n.event in t){const e=t[n.event];e&&e(n)}}catch{}}(e,{init:()=>{j(!0)},load:e=>{u&&u(e)},configure:e=>{s&&b.configure({config:s}),f&&f(e)},autosave:e=>{p&&p(e)},save:e=>{b.exportDiagram({format:l||"xmlsvg",exit:e.exit,parentEvent:"save"})},exit:e=>{d&&d(e)},draft:e=>{g&&g(e)},export:e=>{m&&m({event:"save",xml:e.data,parentEvent:e.message.parentEvent||"export"}),x&&x(e),e.message.exit&&d&&d({event:"exit",modified:!0,parentEvent:e.message.parentEvent||"export"})},merge:e=>{v&&v(e)},prompt:e=>{h&&h(e)},template:e=>{E&&E(e)}},r)};return(0,a.useImperativeHandle)(t,(()=>({...b})),[]),(0,a.useEffect)((()=>{let e={};y&&(e=i?"xmlpng"===l?{xmlpng:i}:{xml:i}:c?{descriptor:{format:"csv",data:c}}:{xml:""},e={...e,autosave:n},b.load(e))}),[y,i,c,n]),(0,a.useEffect)((()=>(window.addEventListener("message",k),()=>{window.removeEventListener("message",k)})),[]),a.createElement("iframe",{className:"diagrams-iframe",src:S,ref:w,title:"Diagrams.net",style:{width:"100%",height:"100%",minWidth:"400px",minHeight:"400px",border:"none"}})}));var s=n(74848);const i=e=>(e=>{const t=e.match(/<content>(.*?)<\/content>/s);if(t){const e=t[1];if(/^([A-Za-z0-9+/=]+)$/.test(e)){return'<?xml version="1.0" encoding="UTF-8"?>\n'+atob(e)}}return e})(e),c=()=>{const e=new URLSearchParams((0,r.zy)().search).get("src"),[t,n]=(0,a.useState)(null);return(0,a.useEffect)((()=>{e&&(async e=>{try{const t=await fetch(e),a=await t.text();n(i(a))}catch(t){console.error("\u52a0\u8f7d SVG \u6587\u4ef6\u5931\u8d25:",t)}})(e)}),[e]),(0,s.jsx)("div",{style:{height:"100vh",display:"flex",flexDirection:"column"},children:t?(0,s.jsx)(o,{xml:t,urlParameters:{ui:"dark",spin:!0,libraries:!0,saveAndExit:!1,noSaveBtn:!0,noExitBtn:!0}}):(0,s.jsxs)("p",{children:["\u672a\u627e\u5230\u56fe\u5f62\u6587\u4ef6: ",e]})})},l=()=>(0,s.jsx)(c,{})}}]);